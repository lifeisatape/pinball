# üéØ –§–ò–ù–ê–õ–¨–ù–´–ï –ö–†–ò–¢–ò–ß–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

## ‚ùå –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞–∑–ª–∏—á–∏—è —Å —Ä–∞–±–æ—á–∏–º —Ñ–∞–π–ª–æ–º:

### 1. **–£–ë–†–ê–¢–¨ –ª–∏—à–Ω–∏–π –≤—ã–∑–æ–≤ –∑–≤—É–∫–∞ –≤ initializeGame()**

**–ù–ê–ô–¢–ò –≤ initializeGame():**
```javascript
// –ò–≥—Ä–∞–µ–º –∑–≤—É–∫ –∑–∞–ø—É—Å–∫–∞ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
this.playSound('newGameLaunch');
```

**–£–î–ê–õ–ò–¢–¨ —ç—Ç–∏ 2 —Å—Ç—Ä–æ–∫–∏!** –í —Ä–∞–±–æ—á–µ–º —Ñ–∞–π–ª–µ —ç—Ç–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ù–ï–¢ –≤ initializeGame().

### 2. **–ò–°–ü–†–ê–í–ò–¢–¨ setupEventListeners() - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**

**–ù–ê–ô–¢–ò:**
```javascript
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ "tap to start"
this.tapToStartScreen.addEventListener('click', () => {
    console.log('üéÆ User clicked TAP TO START');
    this.userHasInteracted = true;
    this.activateAudioContext();
    this.startGame();
});

this.tapToStartScreen.addEventListener('touchstart', () => {
    console.log('üéÆ User touched TAP TO START');
    this.userHasInteracted = true;
    this.activateAudioContext();
    this.startGame();
}, { passive: true });
```

**–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:**
```javascript
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ "tap to start"
this.tapToStartScreen.addEventListener('click', async () => {
    console.log('PinballGame: User clicked TAP TO START');
    this.userHasInteracted = true;
    
    // –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –∞–∫—Ç–∏–≤–∞—Ü–∏—è AudioContext
    await this.activateAudioContext();
    
    this.startLoadingProcess();
});

this.tapToStartScreen.addEventListener('touchstart', async () => {
    console.log('PinballGame: User touched TAP TO START');
    this.userHasInteracted = true;
    
    // –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –∞–∫—Ç–∏–≤–∞—Ü–∏—è AudioContext
    await this.activateAudioContext();
    
    this.startLoadingProcess();
}, { passive: true });
```

### 3. **–î–û–ë–ê–í–ò–¢–¨ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**

**–ù–ê–ô–¢–ò –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –ø–æ—Å–ª–µ this.userHasInteracted = false:**
```javascript
// ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–≤—É–∫–æ–≤
this.soundsLoaded = false;
```

**–î–û–ë–ê–í–ò–¢–¨ –ü–û–°–õ–ï:**
```javascript
// –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
this.loadingState = {
    audio: false,
    sounds: false,
    levels: false
};
```

### 4. **–î–û–ë–ê–í–ò–¢–¨ –º–µ—Ç–æ–¥ startLoadingProcess()**

**–î–û–ë–ê–í–ò–¢–¨ –ü–û–°–õ–ï startGame():**
```javascript
async startLoadingProcess() {
    // –ó–ê–©–ò–¢–ê –û–¢ –ê–í–¢–û–ó–ê–ü–£–°–ö–ê!
    if (!this.userHasInteracted) {
        console.log('PinballGame: Blocking auto-start - user must click TAP TO START first');
        return;
    }

    console.log('PinballGame: Starting loading process...');
    // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω "tap to start" –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
    this.tapToStartScreen.style.display = 'none';
    this.showLevelSelectScreen();
}
```

### 5. **–ò–°–ü–†–ê–í–ò–¢–¨ activateAudioContext() –Ω–∞ —Ä–∞–±–æ—á—É—é –≤–µ—Ä—Å–∏—é**

**–ó–ê–ú–ï–ù–ò–¢–¨ –≤–µ—Å—å –º–µ—Ç–æ–¥ activateAudioContext():**
```javascript
async activateAudioContext() {
    console.log('PinballGame: Activating AudioContext immediately...');
    
    if (!window.soundManager || !window.soundManager.audioContext) {
        console.warn('PinballGame: SoundManager not ready for activation');
        return;
    }

    try {
        const context = window.soundManager.audioContext;
        console.log('PinballGame: AudioContext state before activation:', context.state);

        // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å –¥–≤—É–º—è –ø–æ–ø—ã—Ç–∫–∞–º–∏
        for (let attempt = 1; attempt <= 2; attempt++) {
            try {
                await context.resume();
                console.log(`PinballGame: AudioContext activation attempt ${attempt}, state:`, context.state);
                
                if (context.state === 'running') {
                    console.log('PinballGame: AudioContext successfully activated!');
                    return;
                }
            } catch (error) {
                console.warn(`PinballGame: AudioContext activation attempt ${attempt} failed:`, error);
            }
            
            // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
            if (attempt < 2) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        console.warn('PinballGame: AudioContext activation failed after 2 attempts, state:', context.state);
    } catch (error) {
        console.error('PinballGame: Error during AudioContext activation:', error);
    }
}
```

## üéØ –ü–û–ß–ï–ú–£ –≠–¢–û –ö–†–ò–¢–ò–ß–ù–û:

1. **–õ–∏—à–Ω–∏–π –∑–≤—É–∫ –≤ initializeGame()** - –º–µ—à–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** - –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å startLoadingProcess(), –Ω–µ startGame()
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏** - –Ω—É–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
4. **–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π activateAudioContext** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢:

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏–≥—Ä–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–¢–û–ß–ù–û** –∫–∞–∫ —Ä–∞–±–æ—á–∏–π —Ñ–∞–π–ª!