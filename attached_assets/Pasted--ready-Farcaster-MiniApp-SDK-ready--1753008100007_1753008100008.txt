–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –∫–æ–¥–µ:

–ü–æ–∑–¥–Ω–∏–π –≤—ã–∑–æ–≤ ready(): –í Farcaster MiniApp SDK –º–µ—Ç–æ–¥ ready() –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å splash screen. –í –≤–∞—à–µ–º –∫–æ–¥–µ –≤—ã–∑–æ–≤ ready() –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (–∑–≤—É–∫–æ–≤, —É—Ä–æ–≤–Ω–µ–π –∏ —Ç.–¥.), —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Farcaster SDK: –í–∞—à FarcasterManager –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ Farcaster Manager: –ù–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

–í–æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. –ò—Å–ø—Ä–∞–≤—å—Ç–µ FarcasterManager (FarcasterManager.js)
javascript
class FarcasterManager {
    constructor() {
        this.isFrameEnvironment = false;
        this.isReady = false;
        this.context = null;
        this.user = null;
        this.sdk = null;
        this.callbacks = { /* ... */ };

        // –£–¥–∞–ª–∏—Ç–µ –≤—ã–∑–æ–≤ this.init() –∏–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
    }

    // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    async initialize() {
        console.log('FarcasterManager: Initializing...');
        
        if (!window.isMiniApp) {
            console.log('‚è≠Ô∏è Not in Mini App environment, skipping Farcaster initialization');
            this.simulateReady();
            return;
        }

        // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK
        try {
            console.log('üîÑ Loading Farcaster SDK...');
            const { default: sdk } = await import('https://esm.sh/@farcaster/miniapp-sdk');
            this.sdk = sdk;
            this.isFrameEnvironment = true;
            console.log('‚úÖ Farcaster SDK initialized successfully');
            
            await this.setupMiniAppFeatures();
        } catch (error) {
            console.error('‚ùå Error loading Farcaster SDK:', error);
            this.isFrameEnvironment = false;
            this.simulateReady();
        }
    }

    async setupMiniAppFeatures() {
        try {
            // –í–ê–ñ–ù–û: –í—ã–∑–æ–≤–∏—Ç–µ ready() —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è SDK!
            await this.notifyAppReady();
            
            // –û—Å—Ç–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...
            this.context = await this.sdk.context;
            // ...
        } catch (error) {
            console.error('Error setting up Mini App features:', error);
            this.simulateReady();
        }
    }

    async notifyAppReady() {
        if (this.isFrameEnvironment && this.sdk?.actions?.ready) {
            try {
                await this.sdk.actions.ready({
                    disableNativeGestures: false
                });
                console.log('üéâ Farcaster splash screen dismissed');
                return true;
            } catch (error) {
                console.error('‚ùå Failed to dismiss splash screen:', error);
            }
        }
        return false;
    }

    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ —Å—Ä–∞–∑—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
console.log('Creating global FarcasterIntegration instance...');
window.farcasterIntegration = new FarcasterManager();
window.farcasterIntegration.initialize(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ä–∞–∑—É!
2. –ò–∑–º–µ–Ω–∏—Ç–µ HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É
html
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ... –º–µ—Ç–∞—Ç–µ–≥–∏ ... -->
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ Farcaster SDK -->
    <script type="module">
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        window.isMiniApp = window.parent !== window || 
                          document.referrer.includes('warpcast.com') ||
                          document.referrer.includes('farcaster');
        
        console.log('Mini App environment detected:', window.isMiniApp);
    </script>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ FarcasterManager -->
    <script src="core/FarcasterManager.js"></script>
    
    <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="core/SoundManager.js"></script>
    <!-- ... -->
</head>
<body>
    <!-- ... –≤–∞—à–∞ —Ä–∞–∑–º–µ—Ç–∫–∞ ... -->
</body>
</html>
3. –£–ø—Ä–æ—Å—Ç–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ PinballGame.js
javascript
class PinballGame {
    constructor() {
        // ... –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ...

        this.setupEventListeners();
        this.showTapToStartScreen();
    }

    async setupFarcasterIntegration() {
        console.log('PinballGame: Setting up Farcaster integration...');
        
        // –ï—Å–ª–∏ SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∂–¥–µ–º –µ–≥–æ
        if (!window.farcasterIntegration) {
            console.warn('FarcasterIntegration not available yet, waiting...');
            await new Promise(resolve => {
                const check = setInterval(() => {
                    if (window.farcasterIntegration && window.farcasterIntegration.isReady) {
                        clearInterval(check);
                        resolve();
                    }
                }, 100);
            });
        }

        // –í—ã–∑—ã–≤–∞–µ–º ready –µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∏
        if (window.farcasterIntegration.isInFrame()) {
            console.log('Detected Farcaster frame environment');
            
            // –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º UI
            try {
                await this.adaptUIForFrame();
            } catch (error) {
                console.error('Error adapting UI:', error);
            }
        }
    }

    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
4. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ
javascript
window.addEventListener('load', async () => {
    console.log('Page loaded, initializing game...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Farcaster Manager –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º
    if (window.farcasterIntegration && !window.farcasterIntegration.isReady) {
        await new Promise(resolve => {
            window.farcasterIntegration.onReady(resolve);
        });
    }
    
    const game = new PinballGame();
});
–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

–†–∞–Ω–Ω–∏–π –≤—ã–∑–æ–≤ ready(): –¢–µ–ø–µ—Ä—å SDK –≤—ã–∑—ã–≤–∞–µ—Ç ready() —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏, –∞ –Ω–µ –∂–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: FarcasterManager —Ç–µ–ø–µ—Ä—å —Å–∞–º–æ–∑–∞–≥—Ä—É–∂–∞—é—â–∏–π—Å—è –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.